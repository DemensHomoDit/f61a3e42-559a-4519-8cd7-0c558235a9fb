{
  "db_path": "C:\\Users\\DemensHomo\\Desktop\\UgraBuilders_rabochka\\bot.db",
  "sqlite_version": "3.49.1",
  "objects": [
    { "name": "absences", "type": "table", "sql": "CREATE TABLE absences (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER,\n            type TEXT,\n            amount REAL,\n            date TEXT, comment TEXT, task_id INTEGER REFERENCES tasks(id), object_id INTEGER REFERENCES objects(id),\n            FOREIGN KEY (user_id) REFERENCES users(id)\n        )" },
    { "name": "assignments", "type": "table", "sql": "CREATE TABLE assignments (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            object_id INTEGER,\n            user_id INTEGER,\n            date TEXT,\n            FOREIGN KEY (object_id) REFERENCES objects(id),\n            FOREIGN KEY (user_id) REFERENCES users(id)\n        )" },
    { "name": "logs", "type": "table", "sql": "CREATE TABLE logs (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER,\n            action TEXT,\n            timestamp TEXT\n        )" },
    { "name": "object_consumptions", "type": "table", "sql": "CREATE TABLE object_consumptions (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            object_id INTEGER,\n            material_id INTEGER,\n            qty_used REAL,\n            date TEXT,\n            task_id INTEGER,\n            notes TEXT,\n            FOREIGN KEY (object_id) REFERENCES objects(id),\n            FOREIGN KEY (material_id) REFERENCES object_materials(id),\n            FOREIGN KEY (task_id) REFERENCES tasks(id)\n        )" },
    { "name": "object_materials", "type": "table", "sql": "CREATE TABLE object_materials (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            object_id INTEGER,\n            name TEXT,\n            qty REAL DEFAULT 0,\n            unit TEXT,\n            notes TEXT,\n            FOREIGN KEY (object_id) REFERENCES objects(id)\n        )" },
    { "name": "object_stages", "type": "table", "sql": "CREATE TABLE object_stages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            object_id INTEGER,\n            name TEXT,\n            description TEXT,\n            status TEXT,\n            start_date TEXT,\n            due_date TEXT,\n            end_date TEXT,\n            progress INTEGER DEFAULT 0,\n            FOREIGN KEY (object_id) REFERENCES objects(id)\n        )" },
    { "name": "object_tools", "type": "table", "sql": "CREATE TABLE object_tools (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            object_id INTEGER,\n            name TEXT,\n            qty REAL DEFAULT 0,\n            unit TEXT,\n            notes TEXT,\n            FOREIGN KEY (object_id) REFERENCES objects(id)\n        )" },
    { "name": "objects", "type": "table", "sql": "CREATE TABLE objects (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            name TEXT UNIQUE,\n            description TEXT,\n            topic_id INTEGER\n        , address TEXT, plan TEXT, goal TEXT, actions TEXT, visibility_admin BOOLEAN DEFAULT 1, visibility_foreman BOOLEAN DEFAULT 1, visibility_worker BOOLEAN DEFAULT 0, created_by INTEGER, created_at TEXT)" },
    { "name": "purchases", "type": "table", "sql": "CREATE TABLE purchases (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            item TEXT,\n            assignee_id INTEGER,\n            status TEXT,\n            message_id INTEGER, amount TEXT, user_id INTEGER REFERENCES users(id), date TEXT, notes TEXT, object_id INTEGER REFERENCES objects(id),\n            FOREIGN KEY (assignee_id) REFERENCES users(id)\n        )" },
    { "name": "salaries", "type": "table", "sql": "CREATE TABLE salaries (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER,\n            amount REAL,\n            date TEXT,\n            reason TEXT, type TEXT DEFAULT 'salary', task_id INTEGER REFERENCES tasks(id), object_id INTEGER REFERENCES objects(id),\n            FOREIGN KEY (user_id) REFERENCES users(id)\n        )" },
    { "name": "settings", "type": "table", "sql": "CREATE TABLE settings (\n            key TEXT PRIMARY KEY,\n            value TEXT\n        )" },
    { "name": "task_photos", "type": "table", "sql": "CREATE TABLE task_photos (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            task_id INTEGER,\n            photo_file_id TEXT,\n            comment TEXT,\n            added_by INTEGER,\n            added_at TEXT,\n            FOREIGN KEY (task_id) REFERENCES tasks(id),\n            FOREIGN KEY (added_by) REFERENCES users(id)\n        )" },
    { "name": "task_reports", "type": "table", "sql": "CREATE TABLE task_reports (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            task_id INTEGER,\n            user_id INTEGER,\n            comment TEXT,\n            photo_path TEXT,\n            volume REAL,\n            unit TEXT,\n            created_at TEXT,\n            FOREIGN KEY (task_id) REFERENCES tasks(id),\n            FOREIGN KEY (user_id) REFERENCES users(id)\n        )" },
    { "name": "task_volumes", "type": "table", "sql": "CREATE TABLE task_volumes (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            task_id INTEGER REFERENCES tasks(id),\n            volume REAL NOT NULL,\n            unit TEXT DEFAULT '°Є',\n            added_by INTEGER REFERENCES users(id),\n            added_at TEXT DEFAULT (datetime('now', 'localtime'))\n        , object_id INTEGER REFERENCES objects(id))" },
    { "name": "tasks", "type": "table", "sql": "CREATE TABLE tasks (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            title TEXT,\n            description TEXT,\n            assignee_id INTEGER,\n            priority TEXT,\n            deadline TEXT,\n            status TEXT,\n            message_id INTEGER, rem24 INTEGER DEFAULT 0, rem2 INTEGER DEFAULT 0, overdue_notified INTEGER DEFAULT 0, object_id INTEGER, work_date DATE, completed_at TEXT, cancelled_at TEXT, created_by INTEGER REFERENCES users(id), task_type TEXT DEFAULT 'work', created_at TEXT, pay_amount REAL, expected_minutes INTEGER, actual_minutes INTEGER, tech_card_id INTEGER REFERENCES tech_cards(id), pay_type TEXT DEFAULT 'none', pay_rate REAL, currency TEXT DEFAULT 'RUB', unit TEXT, planned_volume REAL, auto_pay INTEGER DEFAULT 0,\n            FOREIGN KEY (assignee_id) REFERENCES users(id)\n        )" },
    { "name": "tech_cards", "type": "table", "sql": "CREATE TABLE tech_cards (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            title TEXT,\n            description TEXT,\n            steps_json TEXT\n        , default_expected_minutes INTEGER, default_pay_type TEXT, default_pay_rate REAL, unit TEXT, tags TEXT)" },
    { "name": "timesheets", "type": "table", "sql": "CREATE TABLE timesheets (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER,\n            object_id INTEGER,\n            task_id INTEGER,\n            start_time TEXT,\n            end_time TEXT,\n            duration_minutes INTEGER,\n            kind TEXT DEFAULT 'work',\n            comment TEXT,\n            FOREIGN KEY (user_id) REFERENCES users(id),\n            FOREIGN KEY (object_id) REFERENCES objects(id),\n            FOREIGN KEY (task_id) REFERENCES tasks(id)\n        )" },
    { "name": "users", "type": "table", "sql": "CREATE TABLE users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            chat_id INTEGER UNIQUE,\n            full_name TEXT,\n            position TEXT,\n            phone TEXT,\n            is_admin INTEGER DEFAULT 0\n        , role TEXT DEFAULT 'worker')" }
  ],
  "details": {
    "absences": { "count": 4, "sample": [
      { "id": 8, "user_id": 5, "type": "advance", "amount": 25000.0, "date": "2025-07-23", "comment": "", "task_id": null, "object_id": null },
      { "id": 9, "user_id": 5, "type": "advance", "amount": 3000.0, "date": "2025-07-03", "comment": "", "task_id": null, "object_id": null }
    ]},
    "assignments": { "count": 3, "sample": [
      { "id": 1, "object_id": 1, "user_id": 4, "date": "2025-07-04" }
    ]},
    "objects": { "count": 2, "sample": [
      { "id": 1, "name": "Объект А", "description": "", "topic_id": 5, "address": "Адрес А", "plan": null, "goal": null, "actions": null, "visibility_admin": 1, "visibility_foreman": 1, "visibility_worker": 0, "created_by": null, "created_at": null },
      { "id": 2, "name": "Объект Б", "description": "", "topic_id": null, "address": "Адрес Б", "plan": null, "goal": null, "actions": null, "visibility_admin": 1, "visibility_foreman": 1, "visibility_worker": 0, "created_by": null, "created_at": null }
    ]},
    "tasks": { "count": 1, "sample": [
      { "id": 26, "title": "Задача 1", "description": "Описание", "assignee_id": 5, "priority": "high", "deadline": "2025-08-09T12:00", "status": "new", "object_id": 1, "work_date": "2025-08-08", "created_by": 1, "task_type": "construction", "created_at": "2025-08-08T18:28:47", "pay_type": "none", "currency": "RUB", "auto_pay": 0 }
    ]},
    "users": { "count": 3, "sample": [
      { "id": 1, "chat_id": 414682869, "full_name": "Админ", "position": null, "phone": null, "is_admin": 1, "role": "admin" },
      { "id": 4, "chat_id": 802201047, "full_name": "Прораб П.", "position": null, "phone": null, "is_admin": 0, "role": "foreman" },
      { "id": 5, "chat_id": 5031842374, "full_name": "Рабочий Р.", "position": null, "phone": null, "is_admin": 0, "role": "worker" }
    ]}
  }
} 